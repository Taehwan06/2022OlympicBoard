<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="EUC-KR"%>
<%@ page import="java.sql.*" %>
<%@ page import="OlympicBoard.vo.*" %>
<%@ page import="OlympicBoard.util.*" %>
<%
	int cnt = 0;

	Member loginUser = (Member)session.getAttribute("loginUser");
	if(loginUser == null){
		response.sendRedirect(request.getContextPath());
	}else{
		int midx = loginUser.getMidx();

		Connection conn = null;
		PreparedStatement psmt = null;
		ResultSet rs = null;
		
		try{
			conn = DBManager.getConnection();
			
			String sql = "select * from (select count(*) c from board where midx=?)";
			psmt = conn.prepareStatement(sql);
			psmt.setInt(1,midx);
			
			rs = psmt.executeQuery();
			
			if(rs.next()){
				cnt = rs.getInt("c");
			}
		}catch(Exception e){
			e.printStackTrace();
		}finally{
			DBManager.close(psmt,conn,rs);
		}
%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>마이 페이지</title>
<link href="<%=request.getContextPath() %>/css/header.css" rel="stylesheet">
<link href="<%=request.getContextPath() %>/css/nav.css" rel="stylesheet">
<link href="<%=request.getContextPath() %>/css/mypage.css" rel="stylesheet">
<link href="<%=request.getContextPath() %>/css/footer.css" rel="stylesheet">
<script src="<%=request.getContextPath()%>/js/jquery-3.6.0.min.js"></script>
<script src="<%=request.getContextPath()%>/js/mypage.js"></script>
</head>
<body>
	<%@ include file="/loginHeader.jsp" %>
	<%@ include file="/nav.jsp" %>
	<section>
		<div>		
			<div>
				<div class="border">
					<span class="left">아이디</span>
					<span class="right"><%=loginUser.getMemberid() %></span>
				</div>
				<div class="border">
					<span class="left">성명</span>
					<span class="right"><%=loginUser.getMembername() %></span>
				</div>
				<div class="border">
					<span class="left">연락처</span>
					<span class="right"><%=loginUser.getPhone() %></span>
				</div>
				<div class="border">
					<span class="left">이메일 주소</span>
					<span class="right"><%=loginUser.getEmail() %></span>
				</div>
				<div class="border">
					<span class="left">가입일</span>
					<span class="right"><%=loginUser.getEnterdate() %></span>
				</div>
				<div class="border">
					<span class="left">작성한 게시글 수</span>
					<span class="right"><%=cnt %></span>
				</div>
			</div>
			<div class="button">
				<div class="border" onclick="mylistFn()">
					<span>내가 쓴 글 보러가기</span>
				</div><br>
				<div class="border" onclick="modifyFn()()">
					<span>회원정보 수정</span>
				</div><br>
				<div class="border" onclick="withdrawFn()">
					<span>회원 탈퇴</span>
				</div>
			</div>
		</div>
	</section>
	<%@ include file="/footer.jsp" %>
</body>
</html>
<%
	}
	session.setAttribute("check",null);
%>